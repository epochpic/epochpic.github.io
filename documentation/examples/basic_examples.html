<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Source Themes Academic 4.8.0"><meta name=description content="In this section we outline a few worked examples of setting up problems using the EPOCH input deck.
Electron two stream instability An obvious simple test problem to do with EPOCH is the electron two stream instability."><link rel=alternate hreflang=en-us href=/documentation/examples/basic_examples.html><meta name=theme-color content="#3f51b5"><script src=/js/mathjax-config.js></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css crossorigin=anonymous title=hl-light><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark disabled><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin=anonymous async></script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js integrity crossorigin=anonymous async></script><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap"><link rel=stylesheet href=/css/academic.css><link rel=manifest href=/index.webmanifest><link rel=icon type=image/png href=/images/icon_hucf2a1ead28adac6bbe3177e5d4e4a1f0_753_32x32_fill_lanczos_center_2.png><link rel=apple-touch-icon type=image/png href=/images/icon_hucf2a1ead28adac6bbe3177e5d4e4a1f0_753_192x192_fill_lanczos_center_2.png><link rel=canonical href=/documentation/examples/basic_examples.html><meta property="twitter:card" content="summary"><meta property="og:site_name" content="EPOCH"><meta property="og:url" content="/documentation/examples/basic_examples.html"><meta property="og:title" content="Basic examples | EPOCH"><meta property="og:description" content="In this section we outline a few worked examples of setting up problems using the EPOCH input deck.
Electron two stream instability An obvious simple test problem to do with EPOCH is the electron two stream instability."><meta property="og:image" content="/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_300x300_fit_lanczos_2.png"><meta property="twitter:image" content="/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_300x300_fit_lanczos_2.png"><meta property="og:locale" content="en-us"><meta property="article:modified_time" content="2023-10-26T13:27:50+01:00"><title>Basic examples | EPOCH</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents><aside class=search-results id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=#><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/><img src=/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_0x70_resize_lanczos_2.png alt=EPOCH></a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/><img src=/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_0x70_resize_lanczos_2.png alt=EPOCH></a></div><div class="navbar-collapse main-menu-item collapse justify-content-end" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/quickstart.html><span>Quick Start</span></a></li><li class=nav-item><a class=nav-link href=/documentation.html><span>User Guide</span></a></li><li class=nav-item><a class=nav-link href=/developer.html><span>Dev Guide</span></a></li><li class=nav-item><a class=nav-link href=/publication.html><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/license.html><span>License</span></a></li><li class=nav-item><a class=nav-link href=/contact.html><span>Contact</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=#><i class="fas fa-search" aria-hidden=true></i></a></li></ul></div></nav><div class="container-fluid docs"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 docs-sidebar"><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-3" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation">
<span><i class="fas fa-bars"></i></span></button>
<input name=q type=search class=form-control placeholder=Search... autocomplete=off></form><nav class="collapse docs-links" id=docs-nav><div class=docs-toc-item><a class=docs-toc-link href=/documentation.html>Overview</a></div><div class=docs-toc-item><a class=docs-toc-link href=/documentation/basic_usage.html>Basic usage</a><ul class="nav docs-sidenav"><li><a href=/documentation/basic_usage/faq.html>FAQs</a></li><li><a href=/documentation/basic_usage/structure.html>Structure</a></li><li><a href=/documentation/basic_usage/compiling.html>Compiling</a></li><li><a href=/documentation/basic_usage/compiler_flags.html>Compiler Flags</a></li><li><a href=/documentation/basic_usage/running.html>Running</a></li><li><a href=/documentation/basic_usage/acknowledging_epoch.html>Acknowledging EPOCH</a></li><li><a href=/documentation/basic_usage/libraries.html>Libraries</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/documentation/input_deck/input_deck.html>Input deck</a><ul class="nav docs-sidenav"><li><a href=/documentation/input_deck/input_deck_antenna.html>Antenna block</a></li><li><a href=/documentation/input_deck/input_deck_boundaries.html>Boundaries block</a></li><li><a href=/documentation/input_deck/input_deck_bremsstrahlung.html>Bremsstrahlung block</a></li><li><a href=/documentation/input_deck/input_deck_collisions.html>Collisions block</a></li><li><a href=/documentation/input_deck/input_deck_constant.html>Constant block</a></li><li><a href=/documentation/input_deck/input_deck_control.html>Control block</a></li><li><a href=/documentation/input_deck/input_deck_dist_fn.html>Dist_fn block</a></li><li><a href=/documentation/input_deck/input_deck_fields.html>Fields block</a></li><li><a href=/documentation/input_deck/input_deck_injector.html>Injector block</a></li><li><a href=/documentation/input_deck/input_deck_laser.html>Laser block</a></li><li><a href=/documentation/input_deck/input_deck_output_block.html>Output block</a></li><li><a href=/documentation/input_deck/input_deck_output_global.html>Output_global block</a></li><li><a href=/documentation/input_deck/input_deck_particle_file.html>Particles_from_file block</a></li><li><a href=/documentation/input_deck/input_deck_probe.html>Probe block</a></li><li><a href=/documentation/input_deck/input_deck_qed.html>QED block</a></li><li><a href=/documentation/input_deck/input_deck_species.html>Species block</a></li><li><a href=/documentation/input_deck/input_deck_subset.html>Subset block</a></li><li><a href=/documentation/input_deck/input_deck_window.html>Window block</a></li><li><a href=/documentation/input_deck/binary_files.html>Binary files</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/documentation/code_details.html>Code details</a><ul class="nav docs-sidenav"><li><a href=/documentation/code_details/maths_parser.html>Maths parser</a></li><li><a href=/documentation/code_details/using_epoch_in_practice.html>Using EPOCH in practice</a></li><li><a href=/documentation/code_details/using_delta_f.html>Using delta f</a></li><li><a href=/documentation/code_details/previous_versions.html>Previous versions</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/documentation/visualising_output.html>Visualising output</a><ul class="nav docs-sidenav"><li><a href=/documentation/visualising_output/visualising_sdf_files_with_idl_or_gdl.html>IDL or GDL</a></li><li><a href=/documentation/visualising_output/visualising_sdf_files_with_llnl_visit.html>LLNL VisIt</a></li><li><a href=/documentation/visualising_output/python_beam.html>Python BEAM</a></li><li><a href=/documentation/visualising_output/python_sdf_helper.html>Python sdf_helper</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/documentation/examples.html>Examples</a><ul class="nav docs-sidenav"><li class=active><a href=/documentation/examples/basic_examples.html>Basic examples</a></li><li><a href=/documentation/examples/workshop_examples.html>Workshop examples</a></li><li><a href=/documentation/examples/workshop_examples_continued.html>Workshop examples continued</a></li></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>Contents</a></li></ul><nav id=TableOfContents><ul><li><ul><li></li></ul></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role=main><article class=article><div class=docs-article-container><h1>Basic examples</h1><div class=article-style><p>In this section we outline a few worked examples of setting up problems
using the EPOCH input deck.</p><h1 id=electron_two_stream_instability>Electron two stream instability</h1><p>An obvious simple test problem to do with EPOCH is the electron two
stream instability. An example of a nice dramatic two stream instability
can be obtained using EPOCH1D by setting the code with the following
input deck file:</p><pre><code class=language-perl>begin:control
   nx = 400

   # Size of domain
   x_min = 0
   x_max = 5.0e5

   # Final time of simulation
   t_end = 1.5e-1

   stdout_frequency = 400
end:control


begin:boundaries
   bc_x_min = periodic
   bc_x_max = periodic
end:boundaries


begin:constant
   drift_p = 2.5e-24
   temp = 273
   dens = 10
end:constant


begin:species
   # Rightwards travelling electrons
   name = Right
   charge = -1
   mass = 1.0
   temp = temp
   drift_x = drift_p
   number_density = dens
   npart = 4 * nx
end:species


begin:species
   # Leftwards travelling electrons
   name = Left
   charge = -1
   mass = 1.0
   temp = temp
   drift_x = -drift_p
   number_density = dens
   npart = 4 * nx
end:species


begin:output
   # Number of timesteps between output dumps
   dt_snapshot = 1.5e-3

   # Properties at particle positions
   particles = always
   px = always

   # Properties on grid
   grid = always
   ex = always
   ey = always
   ez = always
   bx = always
   by = always
   bz = always
   jx = always
   ekbar = always
   mass_density = never + species
   charge_density = always
   number_density = always + species
   temperature = always + species
end:output
</code></pre><p><img src=Two_Stream_Late.png alt="The final state of the electron phase space for the two streaminstabilityexample">
In this example, the constant block sets up constants for the momentum
space drift, the temperature and the electron number density. The two
species blocks set up the two drifting Maxwellian distributions and the
constant density profile. The final output from this simulation is shown
in the figure.</p><h1 id=structured_density_profile_in_epoch2d>Structured density profile in EPOCH2D</h1><p><img src=EPOCH_density_example.png alt="Complex 2D densitystructure"></p><p>A simple but useful example for EPOCH2D is to have a highly structured
initial condition to show that this is still easy to implement in EPOCH.
A good example initial condition would be:</p><pre><code class=language-perl>begin:control
   nx = 500
   ny = nx
   x_min = -10 * micron
   x_max = -x_min
   y_min =  x_min
   y_max =  x_max
   nsteps = 0
end:control

begin:boundaries
   bc_x_min = periodic
   bc_x_max = periodic
   bc_y_min = periodic
   bc_y_max = periodic
end:boundaries

begin:constant
   den_peak = 1.0e19
end:constant

begin:species
   name = Electron
   number_density = den_peak * (sin(4.0 * pi * x / length_x + pi / 4)) \
                    * (sin(8.0 * pi * y / length_y) + 1)
   number_density_min = 0.1 * den_peak
   charge = -1.0
   mass = 1.0
   npart = 20 * nx * ny
end:species

begin:species
   name = Proton
   number_density = number_density(Electron)
   charge = 1.0
   mass = 1836.2
   npart = 20 * nx * ny
end:species

begin:output
   number_density = always + species
end:output
</code></pre><p>The species block for <strong>Electron</strong> is specified first, setting up the
electron density to be a structured 2D sinusoidal profile. The species
block for <strong>Proton</strong> is then set to match the density of <strong>Electron</strong>,
enforcing charge neutrality. On its own this initial condition does
nothing and so only needs to run for 0 timesteps (<strong>nsteps = 0</strong> in
input.deck). The resulting electron number density should look like the
figure.</p><h1 id=a_hollow_cone_in_3d>A hollow cone in 3D</h1><p>A more useful example of an initial condition is to create a hollow
cone. This is easy to do in both 2D and 3D, but is presented here in 3D
form.</p><pre><code class=language-perl>begin:control
   nx = 250
   ny = nx
   nz = nx
   x_min = -10 * micron
   x_max = -x_min
   y_min = x_min
   y_max = x_max
   z_min = x_min
   z_max = x_max
   nsteps = 0
end:control

begin:boundaries
   bc_x_min = simple_laser
   bc_x_max = simple_outflow
   bc_y_min = periodic
   bc_y_max = periodic
   bc_z_min = periodic
   bc_z_max = periodic
end:boundaries

begin:output
   number_density = always + species
end:output

begin:constant
   den_cone = 1.0e22
   ri = abs(x - 5.0e-6) - 0.5e-6
   ro = abs(x - 5.0e-6) + 0.5e-6
   xi = 3.0e-6 - 0.5e-6
   xo = 3.0e-6 + 0.5e-6
   r = sqrt(y^2 + z^2)
end:constant

begin:species
   name = proton
   charge = 1.0
   mass = 1836.2
   number_density = if((r gt ri) and (r lt ro), den_cone, 0.0)
   number_density = if((x gt xi) and (x lt xo) and (r lt ri), \
                       den_cone, number_density(proton))
   number_density = if(x gt xo, 0.0, number_density(proton))
   npart = nx * ny * nz
end:species

begin:species
   name = electron
   charge = -1.0
   mass = 1.0
   number_density = number_density(proton)
   npart = nx * ny * nz
end:species
</code></pre><h4 id=3d_cone>Cone initial conditions in 3D</h4><p><img src=3dcone.png alt="Cone initial conditions in 3D"></p><h4 id=2d_cone>Cone initial conditions in 2D</h4><p><img src=2dcone.png alt="Cone initial conditions in 2D"></p><p>To convert this to 2D, simply replace the line <code>r = sqrt(y^2+z^2)</code> with
the line <code>r = abs(y)</code>. The actual work in these initial conditions is
done by the three lines inside the block for the <strong>Proton</strong> species.
Each of these lines performs a very specific function:</p><ol><li>Creates the outer cone. Simply tests whether <strong>r</strong> is within the
range of radii which corresponds to the thickness of the cone and if
so fills it with the given density. Since the inner radius is x
dependent this produces a cone rather than a cylinder. On its own,
this line produces a pair of cones joined at the tip.</li><li>Creates the solid tip of the cone. This line just tests whether the
point in space is within the outer radius of the cone and within a
given range in <strong>x</strong>, and fills it with the given density if true.</li><li>Cuts off all of the cone beyond the solid tip. Simply tests if <strong>x</strong>
is greater than the end of the cone tip and sets the density to zero
if so.</li></ol><p>This deck produces an initial condition as in the Figures in
<a href=#3d_cone>3D</a> and
<a href=#2d_cone>2D</a>
respectively.</p></div><div class=article-widget><div class=post-nav><div class=post-nav-item><div class=meta-nav>Next</div><a href=/documentation/examples/workshop_examples.html rel=prev>Workshop examples</a></div></div></div></div><div class=body-footer><p>Last updated on Oct 26, 2023</p></div></article><footer class=site-footer><p class=powered-by>Powered by the
<a href=https://sourcethemes.com/academic/ target=_blank rel=noopener>Academic theme</a> for
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a>.</p></footer></main></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin=anonymous></script><script>const code_highlighting=!0</script><script>const isSiteThemeDark=!1</script><script>const search_config={indexURI:"/index.json",minLength:1,threshold:.3},i18n={no_results:"No results found",placeholder:"Search...",results:"results found"},content_type={post:"Posts",project:"Projects",publication:"Publications",talk:"Talks"}</script><script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin=anonymous></script><script>anchors.add()</script><script id=search-hit-fuse-template type=text/x-template>
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script><script src=/js/academic.min.6f1005d1a84220e2f466ff3d8e712f31.js></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div></body></html>
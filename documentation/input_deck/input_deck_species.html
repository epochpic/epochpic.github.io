<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Source Themes Academic 4.8.0"><meta name=description content="This block contains information about the species of particles which are used in the code. Also details of how these are initialised. See EPOCH input deck for more information on the input deck."><link rel=alternate hreflang=en-us href=/documentation/input_deck/input_deck_species.html><meta name=theme-color content="#3f51b5"><script src=/js/mathjax-config.js></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css crossorigin=anonymous title=hl-light><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark disabled><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin=anonymous async></script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js integrity crossorigin=anonymous async></script><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap"><link rel=stylesheet href=/css/academic.css><link rel=manifest href=/index.webmanifest><link rel=icon type=image/png href=/images/icon_hucf2a1ead28adac6bbe3177e5d4e4a1f0_753_32x32_fill_lanczos_center_2.png><link rel=apple-touch-icon type=image/png href=/images/icon_hucf2a1ead28adac6bbe3177e5d4e4a1f0_753_192x192_fill_lanczos_center_2.png><link rel=canonical href=/documentation/input_deck/input_deck_species.html><meta property="twitter:card" content="summary"><meta property="og:site_name" content="EPOCH"><meta property="og:url" content="/documentation/input_deck/input_deck_species.html"><meta property="og:title" content="species block | EPOCH"><meta property="og:description" content="This block contains information about the species of particles which are used in the code. Also details of how these are initialised. See EPOCH input deck for more information on the input deck."><meta property="og:image" content="/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_300x300_fit_lanczos_2.png"><meta property="twitter:image" content="/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_300x300_fit_lanczos_2.png"><meta property="og:locale" content="en-us"><meta property="article:modified_time" content="2023-02-23T11:15:25+00:00"><title>species block | EPOCH</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents><aside class=search-results id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=#><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/><img src=/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_0x70_resize_lanczos_2.png alt=EPOCH></a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/><img src=/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_0x70_resize_lanczos_2.png alt=EPOCH></a></div><div class="navbar-collapse main-menu-item collapse justify-content-end" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/quickstart.html><span>Quick Start</span></a></li><li class=nav-item><a class=nav-link href=/documentation.html><span>User Guide</span></a></li><li class=nav-item><a class=nav-link href=/developer.html><span>Dev Guide</span></a></li><li class=nav-item><a class=nav-link href=/publication.html><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/license.html><span>License</span></a></li><li class=nav-item><a class=nav-link href=/contact.html><span>Contact</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=#><i class="fas fa-search" aria-hidden=true></i></a></li></ul></div></nav><div class="container-fluid docs"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 docs-sidebar"><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-3" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation">
<span><i class="fas fa-bars"></i></span></button>
<input name=q type=search class=form-control placeholder=Search... autocomplete=off></form><nav class="collapse docs-links" id=docs-nav><div class=docs-toc-item><a class=docs-toc-link href=/documentation.html>Overview</a></div><div class=docs-toc-item><a class=docs-toc-link href=/documentation/basic_usage.html>Basic usage</a><ul class="nav docs-sidenav"><li><a href=/documentation/basic_usage/faq.html>FAQs</a></li><li><a href=/documentation/basic_usage/structure.html>Structure</a></li><li><a href=/documentation/basic_usage/compiling.html>Compiling</a></li><li><a href=/documentation/basic_usage/compiler_flags.html>Compiler Flags</a></li><li><a href=/documentation/basic_usage/running.html>Running</a></li><li><a href=/documentation/basic_usage/acknowledging_epoch.html>Acknowledging EPOCH</a></li><li><a href=/documentation/basic_usage/libraries.html>Libraries</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/documentation/input_deck/input_deck.html>Input deck</a><ul class="nav docs-sidenav"><li><a href=/documentation/input_deck/input_deck_bremsstrahlung.html>bremsstrahlung block</a></li><li><a href=/documentation/input_deck/input_deck_control.html>control block</a></li><li><a href=/documentation/input_deck/input_deck_boundaries.html>boundaries block</a></li><li class=active><a href=/documentation/input_deck/input_deck_species.html>species block</a></li><li><a href=/documentation/input_deck/input_deck_laser.html>laser block</a></li><li><a href=/documentation/input_deck/input_deck_fields.html>fields block</a></li><li><a href=/documentation/input_deck/input_deck_window.html>window block</a></li><li><a href=/documentation/input_deck/input_deck_output_block.html>output block</a></li><li><a href=/documentation/input_deck/input_deck_output_global.html>output_global block</a></li><li><a href=/documentation/input_deck/input_deck_dist_fn.html>dist_fn block</a></li><li><a href=/documentation/input_deck/input_deck_probe.html>probe block</a></li><li><a href=/documentation/input_deck/input_deck_collisions.html>collisions block</a></li><li><a href=/documentation/input_deck/input_deck_qed.html>qed block</a></li><li><a href=/documentation/input_deck/input_deck_subset.html>subset block</a></li><li><a href=/documentation/input_deck/input_deck_constant.html>constant block</a></li><li><a href=/documentation/input_deck/input_deck_injector.html>injector block</a></li><li><a href=/documentation/input_deck/input_deck_antenna.html>Input deck antenna</a></li><li><a href=/documentation/input_deck/input_deck_particle_file.html>Input deck particle file</a></li><li><a href=/documentation/input_deck/binary_files.html>Binary files</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/documentation/code_details.html>Code details</a><ul class="nav docs-sidenav"><li><a href=/documentation/code_details/maths_parser.html>Maths parser</a></li><li><a href=/documentation/code_details/using_epoch_in_practice.html>Using EPOCH in practice</a></li><li><a href=/documentation/code_details/using_delta_f.html>Using delta f</a></li><li><a href=/documentation/code_details/previous_versions.html>Previous versions</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/documentation/visualising_output.html>Visualising output</a><ul class="nav docs-sidenav"><li><a href=/documentation/visualising_output/visualising_sdf_files_with_idl_or_gdl.html>IDL or GDL</a></li><li><a href=/documentation/visualising_output/visualising_sdf_files_with_llnl_visit.html>LLNL VisIt</a></li><li><a href=/documentation/visualising_output/python.html>Python</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/documentation/examples.html>Examples</a><ul class="nav docs-sidenav"><li><a href=/documentation/examples/basic_examples.html>Basic examples</a></li><li><a href=/documentation/examples/workshop_examples.html>Workshop examples</a></li><li><a href=/documentation/examples/workshop_examples_continued.html>Workshop examples continued</a></li></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>Contents</a></li></ul><nav id=TableOfContents></nav></div><main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role=main><article class=article><div class=docs-article-container><h1>species block</h1><div class=article-style><p>This block contains information about the species of particles which are
used in the code. Also details of how these are initialised. See
<a href=/documentation/input_deck/input_deck>EPOCH
input deck</a> for more information on the
input deck.</p><h1 id=basics>Basics</h1><p>The next section of the input deck describes the particle species used
in the code. An example species block for any EPOCH code is given below.</p><pre><code class=language-perl>begin:species
   name = Electron
   charge = -1.0
   mass = 1.0
   frac = 0.5
   # npart = 2000 * 100
   number_density = 1.e4
   temp = 1e6

   temp_x = 0.0
   temp_y = temp_x(Electron)
   number_density_min = 0.1 * den_max
   number_density = if(abs(x) lt thick, den_max, 0.0)
   number_density = if((x gt -thick) and (abs(y) gt 2e-6), \
                        0.0, number_density(Carbon))
end:species

begin:species
   name = Carbon
   charge = 4.0
   mass = 1836.0*12
   frac = 0.5

   number_density = 0.25*number_density(Electron)
   temp_x = temp_x(Electron)
   temp_y = temp_x(Electron)

   dumpmask = full
end:species
</code></pre><p>Each species block accepts the following parameters:</p><ul><li><p><code>name</code> - This specifies the name of the particle species
defined in the current block. This name can include any alphanumeric
characters in the basic ASCII set. The name is used to identify the
species in any consequent input block and is also used for labelling
species data in any output dumps. It is a mandatory parameter.
**<code>NOTE: IT IS IMPOSSIBLE TO SET TWO SPECIES WITH THE SAME NAME!</code>
**</p></li><li><p><code>charge</code> - This sets the charge of the species in
multiples of the electron charge. Negative numbers are used for
negatively charged particles. This is a mandatory parameter.</p></li><li><p><code>mass</code> - This sets the mass of the species in multiples
of the electron mass. Cannot be negative. This is a mandatory
parameter.</p></li><li><p><code>npart</code> - This specifies the number of pseudoparticles
which should be loaded into the simulation domain for this species
block. Using this parameter is the most convenient way of loading
particles for simulations which contain multiple species with
different number densities. If <em>npart</em> is specified in a species
block then any value given for <em>npart</em> in the
<a href=/documentation/input_deck/input_deck_control><em>control</em></a> block is ignored.
<em>npart</em> should not be specified at the same time as <em>frac</em> within a
<em>species</em> block.</p></li><li><p><code>frac</code> - This specifies what fraction of <em>npart</em> (the
global number of particles specified in the control block) should be
assigned to the species.</p></li></ul><p>**<code>NOTE: frac should not be specified at the same time as npart for a given species.</code>
**</p><ul><li><code>npart_per_cell</code> - Integer parameter which specifies
the number of particles per cell to use for the initial particle
loading. At a later stage this may be extended to allow
&ldquo;npart_per_cell&rdquo; to be a spatially varying function.</li></ul><p>If per-species weighting is used then the value of &ldquo;npart_per_cell&rdquo;
will be the average number of particles per cell. If &ldquo;npart&rdquo; or &ldquo;frac&rdquo;
have also been specified for a species, then they will be ignored.</p><p>To avoid confusion, there is no globally used &ldquo;npart_per_species&rdquo;. If
you want to have a single value to change in the input deck then this
can be achieved using a
<a href=/documentation/input_deck/input_deck_constant><em>constant</em></a> block.</p><ul><li><code>dumpmask</code> - Determines which output dumps will include
this particle species. The dumpmask has the same semantics as those used
by variables in the
<a href=/documentation/input_deck/input_deck_output_block><em>output</em></a>
block. The actual dumpmask from the output block is applied first and
then this one is applied afterwards. For example, if the species block
contains &ldquo;dumpmask = full&rdquo; and the output block contains &ldquo;vx = always&rdquo;
then the particle velocity will be only be dumped at full dumps for this
particle species. The default dumpmask is &ldquo;always&rdquo;.</li><li><code>dump</code> - This logical flag is provided for backwards
compatibility. If set to &ldquo;F&rdquo; it has the same meaning as &ldquo;dumpmask =
never&rdquo;. If set to &ldquo;T&rdquo; it has the same meaning as &ldquo;dumpmask = always&rdquo;.</li><li><code>zero_current</code> - Logical flag switching the particle
species into zero-current particles. Zero-current particles are enabled
if the if the &ldquo;NO_TRACER_PARTICLES&rdquo; precompiler option has not been
used and the &ldquo;zero_current&rdquo; flag is set to true for a given species.
When set, the species will move correctly for its charge and mass, but
contribute no current. This means that these particles are passive
elements in the simulation. In all other respects they are designed to
behave identically to ordinary particles, so they do take part in
collisions by default. This can be prevented using the
<a href=/documentation/input_deck/input_deck_collisions>collision
matrices</a>.
<span style=color:red;font-weight:700>WARNING:</span> Since the
particles effectively have zero weight in terms of their numerical
heating properties, they do not always behave in the same way that an
ordinary particle with weight would behave and this can sometimes lead
to unexpected behaviour. If the purpose is merely to track a subset of a
particle species to use as output then a better mechanism to use is
&ldquo;persistent subsets&rdquo; (see
<a href=/documentation/input_deck/input_deck_subset>here</a>).
&ldquo;tracer&rdquo; is currently accepted as an alias but this will be removed in
version 5.0. &ldquo;zero_current = F&rdquo; is the default value.</li><li><code>identify</code> - Used to identify the type of particle.
Originally this was used for the QED routines, but it has since been adopted for other physics packages too. See
<a href=/documentation/input_deck/input_deck_qed>here</a> for details.</li><li><code>immobile</code> - Logical flag. If this parameter is set to &ldquo;T&rdquo;
then the species will be ignored during the particle push. The default
value is &ldquo;F&rdquo;.</li><li><code>background_species</code> - Logical flag. If set to &ldquo;T&rdquo; the species will
be treated as a non evolving continuum background. No particles are loaded. Any
particle-like specifications will be ignored. Background species are currently
only used by the bremsstrahlung radiation model.
See
<a href=/documentation/input_deck/input_deck_bremsstrahlung>here</a>
for details. Default value is &ldquo;F&rdquo;. &ldquo;background&rdquo; is accepted as an alias.</li></ul><p>The species blocks are also used for specifying initial conditions for
the particle species. The initial conditions in EPOCH can be specified
in various ways, but the easiest way is to specify the initial
conditions in the input deck file. This allows any initial condition
which can be specified everywhere in space by a number density and a
drifting Maxwellian distribution function. These are built up using the
normal maths expressions, by setting the density and temperature for
each species which is then used by the autoloader to actually position
the particles.</p><p>The elements of the species block used for setting initial conditions
are:</p><ul><li><code>number_density</code> - Particle number density in $m^{-3}$. As
soon as a number_density= line has been read, the values are calculated
for the whole domain and are available for reuse on the right hand side
of an expression. This is seen in the above example in the first two
lines for the Electron species, where the number density is first set
and then corrected. If you wish to specify the number density in parts
per cubic metre then you can divide by the &ldquo;cc&rdquo; constant (see
<a href=/documentation/code_details/maths_parser#constants>here</a>). This parameter is
mandatory. &ldquo;density&rdquo; is accepted as an alias.</li><li><code>number_density_min</code> - Minimum particle number density in
$m^{-3}$. When the number density in a cell falls below
number_density_min the autoloader does not load any pseudoparticles
into that cell to minimise the number of low weight, unimportant
particles. If set to 0 then all cells are loaded with particles. This is
the default. &ldquo;density_min&rdquo; is accepted as an alias.</li><li><code>number_density_max</code> - Maximum particle number density in
$m^{-3}$. When the number density in a cell rises above
number_density_max the autoloader clips the number_density to
number_density_max allowing easy implementation of exponential rises
to plateaus. If it is a negative value then no clipping is performed.
This is the default. &ldquo;density_max&rdquo; is accepted as an alias.</li><li><code>mass_density</code> - Particle mass density in $kg,m^{-3}$.
The same as &ldquo;number_density&rdquo; but multiplied by the particle mass. If
you wish to use units of $g,cm^{-3}$ then append the appropriate
multiplication factor. For example: &ldquo;<code>mass_density = 2 * 1e3 / cc</code>&rdquo;.</li><li><code>temp_{x,y,z}</code> - The temperature in each direction for a
thermal distribution in Kelvin.</li><li><code>temp</code> - Sets an isotropic temperature distribution in
Kelvin. If both temp and a specific temp_x, temp_y, temp_z parameter
is specified then the last to appear in the deck has precedence. If
neither are given then the species will have a default temperature of
zero Kelvin.</li><li><code>temp_{x,y,z}_ev, temp_ev</code> - These are the same as the
temperature parameters described above except the units are given in
electronvolts rather than Kelvin, i.e. using 1ev = 11604.5K .</li><li><code>drift_{x,y,z}</code> - Specifies a momentum space offset in
$kg\ ms^{-1}$ to the distribution function for this species. By default,
the drift is zero.</li><li><code>offset</code> - File offset. See below for details.</li></ul><h1 id=loading_data_from_a_file>Loading data from a file</h1><p>It is also possible to set initial conditions for a particle species
using an external file. Instead of specifying the initial conditions
mathematically in the input deck, you specify in quotation marks the
filename of a simple binary file containing the information required.
For more information on what is meant by a &ldquo;simple binary file&rdquo;, see
<a href=/documentation/input_deck/binary_files>here</a>.</p><pre><code class=language-perl>begin:species
   name = Electron
   number_density = 'Data/ic.dat'
   offset = 80000
   temp_x = 'Data/ic.dat'
end:species
</code></pre><p>The sizes of the variables to be filled do not need to be provided: the
code will continue reading until the given variable is filled. Note that
ghost or guard cells should not be included in the file as they cannot
be set this way.</p><p>An additional element is also introduced, the offset element. This is
the offset in bytes from the start of the file to where the data should
be read from. As a given line in the block executes, the file is opened,
the file handle is moved to the point specified by the offset parameter,
the data is read and the file is then closed. Therefore, unless the
offset value is changed between data reading lines the same data will be
read into all the variables. The data is read in as soon as a line is
executed, and so it is perfectly possible to load data from a file and
then modify the data using a mathematical expression.
The example block above is for 10,000 values at double precision, i.e.
8-bytes each. The density data is the first 80,000 bytes of &ldquo;ic.dat&rdquo;.
Bytes 80,000 to 160,000 are the temp_x data.</p><p>The file should be a simple binary file consisting of floating point
numbers of the same precision as <strong>_num</strong> in the core EPOCH code. For
multidimensional arrays, the data is assumed to be written according to
FORTRAN array ordering rules (i.e. column-major order).
<strong><code>NOTE: The files that are expected by this block are SIMPLE BINARY files, NOT FORTRAN unformatted files. It is possible to read FORTRAN unformatted files using the offset element, but care must be taken!</code></strong></p><h1 id=delta_f_parameters>Delta-f parameters</h1><p>The following entries are used for configuring the
<a href=/documentation/code_details/using_delta_f>Delta-f
method</a></p><ul><li><code>number_density_back</code></li><li><code>drift_{x,y,z}_back</code></li><li><code>temp_{x,y,z}_back</code></li><li><code>temp_{x,y,z}_back_ev</code></li><li><code>temp_back</code></li><li><code>temp_back_ev</code></li></ul><p>These all have the same meanings as the parameters listed above that
don&rsquo;t include the &ldquo;_back&rdquo; text, except that they specify the values to
use for the background distribution function.</p><h1 id=particle_migration_between_species>Particle migration between species</h1><p>It is sometimes useful to separate particle species into separate energy
bands and to migrate particles between species when they become more or
less energetic. A method to achieve this functionality has been
implemented. It is specified using two parameters to the &ldquo;control&rdquo;
block:</p><ul><li><code>use_migration</code> - Logical flag which determines whether or
not to use particle migration. The default is &ldquo;F&rdquo;.</li><li><code>migration_interval</code> - The number of timesteps between
each migration event. The default is 1 (migrate at every timestep).
The following parameters are added to the &ldquo;species&rdquo; block:</li><li><code>migrate</code> - Logical flag which determines whether or not to
consider this species for migration. The default is &ldquo;F&rdquo;.</li><li><code>promote_to</code> - The name of the species to promote
particles to.</li><li><code>demote_to</code> - The name of the species to demote particles
to.</li><li><code>promote_multiplier</code> - The particle is promoted when its
energy is greater than &ldquo;promote_multiplier&rdquo; times the local average.
The default value is 1.</li><li><code>demote_multiplier</code> - The particle is demoted when its
energy is less than &ldquo;demote_multiplier&rdquo; times the local average. The
default value is 1.</li><li><code>promote_number_density</code> - The particle is only
considered for promotion when the local number density is less than
&ldquo;promote_number_density&rdquo;. The default value is the largest floating
point number.</li><li><code>demote_number_density</code> - The particle is only considered
for demotion when the local number density is greater than
&ldquo;demote_number_density&rdquo;. The default value is 0.</li></ul><h1 id=ionisation>Ionisation</h1><p>EPOCH now includes both field and collisional ionisation, which can be
activated by switching on keys in different blocks. Previous versions of
EPOCH forced the user to specify ionisation energies for each ion charge
state, but since EPOCH 4.19, these are set automatically using look-up tables.</p><p>Field and collisional ionisation must be switched on in the control block and
collision block respectively, and species which are to be ionised must be
specified in their species block. A basic example of using both ionisation
mechanisms is given below, where non-relevant lines have been omitted.</p><pre><code class=language-perl>begin:control
   use_multi_photon = T
   use_bsi = F
   field_ionisation = T
end:control

begin:collisions
   use_collisional_ionisation = T 
   ci_n_step = 3
end:collisions

begin:species
  name = Carbon
  charge = 0
  atomic_no = 6
  ionise = T
  ionise_limit = 3
  unique_electron_species = T
end:species   

begin:species
  name = Carbon4
  charge = 4
  atomic_no = 6
  ionise = T
  ionisation_electron_species = (Electron4, Electron)
end:species
</code></pre><p>A full summary of the keys used in ionisation has been provided below:</p><ul><li><p><code>field_ionisation</code> - Switches on field ionisation.</p></li><li><p><code>use_collisional_ionisation</code> - Switches on ionisation by collisional
electron impact.</p></li><li><p><code>ci_n_step</code> - Only performs the collisional ionisation calculation
once every <em>n</em> steps, where <em>n</em> is set by this parameter. This is done
to speed up the code, and the default is 1 (every step). When
this is greater than 1, the assumed time-step for the collisional ionisation
calculation is <em>n*dt</em>. Note that an ion may only be ionised once per calculation,
so if <em>n</em> is too high, the number of ions will be underestimated.</p></li><li><p><code>atomic_no</code> - Atomic number of the element. When combined with the
charge, the code can deduce the element and charge-state of the ion, and
may use the appropriate ionisation energy and shell binding energies.</p></li><li><p><code>ionise</code> - Allows ionisation of this species, and generates additional
particle species for each ion charge state.</p></li><li><p><code>ionise_limit</code> - This limits the number of additional particle species to
be generated. In this example, ion macro-particles in the Carbon species can only
be ionised 3 times - ionisation of Carbon3 will not be considered.</p></li><li><p><code>ionisation_electron_species</code> - Name of the electron species to
populate with ejected electrons. This
can be specified as an array in the event that the user wishes some levels
to have a different electron species which can be handy for monitoring
ionisation at specific levels. <code>electron</code> and <code>electron_species</code> are
accepted as synonyms. Either one species for <strong>all</strong> ionisation levels, or one species
for <strong>each</strong> level should be specified. In the Carbon4 example, the user may have
written <code>ionisation_electron_species = Electron</code> to use the Electron species
for all ejected electrons.</p></li><li><p><code>unique_electron_species</code> - If &ldquo;T&rdquo;, this generates a
unique electron species to populate with ejected electrons from each
ion charge state. The user must use this, or <strong>ionisation_electron_species</strong>.</p></li></ul><p>Ionised states are created automatically and are named according to the
ionising species name with a number appended. For example, with the Carbon
species block, the species named &ldquo;Carbon1&rdquo;, &ldquo;Carbon2&rdquo; and &ldquo;Carbon3&rdquo;
are automatically created. Note that for pre-ionised species like the Carbon4 block,
species would be named &ldquo;Carbon41&rdquo;, &ldquo;Carbon42&rdquo;. These species will also
inherit the ``dump''
parameter from their parent species. This behaviour can be overridden by explicitly
adding a species block of the same name with a differing dumpmask.</p><p>Field ionisation consists of three distinct regimes; multiphoton in which
ionisation is best described as absorption of multiple photons, tunnelling
in which deformation of the atomic Coulomb potential is the dominant factor,
and barrier suppression ionisation in which the electric field is strong
enough for an electron to escape classically. It is possible to turn off
multiphoton or barrier suppression ionisation through the input deck
using the following control block parameters:</p><ul><li><p><code>use_multiphoton</code> - Logical flag which turns on modelling
ionisation by multiple photon absorption. This should be set to &ldquo;F&rdquo; if
there is no laser attached to a boundary as it relies on laser frequency.
The default is &ldquo;T&rdquo;.</p></li><li><p><code>use_bsi</code> - Logical flag which turns on barrier suppression
ionisation correction to the tunnelling ionisation model for high intensity
lasers. The default is &ldquo;T&rdquo;.</p></li></ul><p>When collisional ionisation is switched on, ionisation between all electron species and all species which may be ionised is considered - the <code>collide</code> parameter used in the collisions block has no effect on collisional ionisation. Species which may be ionised include any species with <code>ionise=T</code> set, and the ionised variants of this species up to the fully ionised state, or <code>ionise_limit</code>. For electrons, EPOCH will identify any species set as a destination for ejected electrons as an electron species, which can trigger further collisional ionisation. To mark other species as electrons for collisional ionisaiton, the <code>identify</code> key must be used. All electron aliases may be used for <code>identify</code>, including electrons created from pair production.</p><h1 id=species_boundary_conditions>Species Boundary Conditions</h1><ul><li><code>bc_x_min</code> - Boundary condition to be applied to this
species only on the lower x boundary. Can be any normal boundary
condition apart from periodic. If not specified then the global
boundary condition is applied.</li><li><code>bc_x_max</code> - Boundary condition to be applied to this
species only on the upper x boundary. Can be any normal boundary
condition apart from periodic. If not specified then the global
boundary condition is applied.</li><li><code>bc_y_min</code> - Boundary condition to be applied to this
species only on the lower y boundary. Can be any normal boundary
condition apart from periodic. If not specified then the global
boundary condition is applied.</li><li><code>bc_y_max</code> - Boundary condition to be applied to this
species only on the upper y boundary. Can be any normal boundary
condition apart from periodic. If not specified then the global
boundary condition is applied.</li><li><code>bc_z_min</code> - Boundary condition to be applied to this
species only on the lower z boundary. Can be any normal boundary
condition apart from periodic. If not specified then the global
boundary condition is applied.</li><li><code>bc_z_max</code> - Boundary condition to be applied to this
species only on the upper z boundary. Can be any normal boundary
condition apart from periodic. If not specified then the global
boundary condition is applied.</li><li><code>meet_injectors</code> - Logical flag determining whether the
background plasma should be extended to meet the point where
particle injectors operate from. This means that plasma is loaded
one particle shape function length outside the boundary. This means
that it is possible to use an injector to &ldquo;continue&rdquo; an existing
drifting plasma. NOT COMPATIBLE WITH PERIODIC BOUNDARY CONDITIONS!</li></ul><h1 id=maxwell_juttner_distributions>Maxwell Juttner distributions</h1><p>As of version 4.15, EPOCH allows the user to request a Maxwell-J端ttner
distribution rather than a Maxwellian distribution when sampling the
particle momentum for a species.</p><p>This feature does not at present work with the delta_f loader and is
not available for particle injectors. It does work correctly with the
moving window.</p><ul><li><p><code>use_maxwell_juttner</code> - Logical flag determining
whether to sample from the Maxwell-J端ttner distribution when loading
the particle species. If &ldquo;T&rdquo; then Maxwell-J端ttner is used and if
&ldquo;F&rdquo; Maxwellian is used. The default value is &ldquo;F&rdquo;.</p></li><li><p><code>fractional_tail_cutoff</code> - The sampling is carried out using a
rejection method with an arbitrary cut-off. This parameter takes a
floating-point argument which specifies the fraction of maximum
value at which the sampling should be cut off. Smaller values lead
to distortion nearer the peak of the distribution but are faster to
sample. Larger values lead to a better approximation of the
distribution function but are slower to sample. The default value is
0.0001.</p></li></ul><p>If drifts are specified with the Maxwell-J端ttner distribution then the
distribution is calculated in the rest frame and then Lorentz
transformed to the specified drifting frame.</p><h1 id=arbitrary_distribution_functions>Arbitrary Distribution functions</h1><p>As of version 4.15, EPOCH also allows the user to request an arbitrary
non-Maxwellian distribution function to use when sampling the particle
momentum for a species. If combined with a specified drift then the
distribution function is calculated first and the drift is applied to
the resulting particles by Lorentz transform.</p><p>This feature does not at present work with the delta_f loader and is
not available for particle injectors. It does work correctly with the
moving window.</p><ul><li><code>dist_fn</code> - Specifies the functional form of the
distribution function, normalised to have a maximum value of 1. The
variables &ldquo;px&rdquo;, &ldquo;py&rdquo; and &ldquo;pz&rdquo; should be used to parameterise
the x, y and z components of momentum. This may freely vary in space
but temporal variation will be ignored since this is only evaluated
at the start of the simulation.</li></ul><ul><li><code>dist_fn_p{x,y,z}_range</code> - Comma separated pair of
numbers to specify the range of momentum for p_{x,y,z} in SI units.
Should be of the form &ldquo;&lt;lower_range>, &lt;upper_range>&rdquo;</li></ul><p>If a range for a momentum direction is not specified then that momentum
is assumed to be zero. It is up to the user to ensure that the range is
large enough to correctly capture their desired distribution function.
Sampling is by a simple rejection sampling and may be much slower than
the existing Maxwellian sampler. EPOCH will print a warning if a large
number of samples are needed to complete the sampling. If this occurs
then you might need to reduce the range of momentum over which sampling
is considered.</p><p>If the &ldquo;dist_fn&rdquo; key is supplied then any supplied temperature keys
are ignored. An example of setting up a truncated power law distribution
in px would be</p><pre><code class=language-perl>begin:constant
  dens = 10
  v0 = 0.05 * c
  vmax = 0.5 * c
  p0 = v0 * me * (1.0 + 4.0 * x/x_max)
  pmax = vmax * me
  alpha = -2.0
end:constant

begin:species
  name = Electron_pl
  charge = -1
  mass = 1.0
  frac = 0.5
  number_density = dens
  #Truncated power law distribution in px
  dist_fn = exp(-p0/px) * (px/p0)^(alpha)
  dist_fn_px_range = (0, pmax)
end:species
</code></pre></div><div class=article-widget><div class=post-nav><div class=post-nav-item><div class=meta-nav>Previous</div><a href=/documentation/input_deck/input_deck_boundaries.html rel=next>boundaries block</a></div><div class=post-nav-item><div class=meta-nav>Next</div><a href=/documentation/input_deck/input_deck_laser.html rel=prev>laser block</a></div></div></div></div><div class=body-footer><p>Last updated on Feb 23, 2023</p></div></article><footer class=site-footer><p class=powered-by>Powered by the
<a href=https://sourcethemes.com/academic/ target=_blank rel=noopener>Academic theme</a> for
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a>.</p></footer></main></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin=anonymous></script><script>const code_highlighting=!0</script><script>const isSiteThemeDark=!1</script><script>const search_config={indexURI:"/index.json",minLength:1,threshold:.3},i18n={no_results:"No results found",placeholder:"Search...",results:"results found"},content_type={post:"Posts",project:"Projects",publication:"Publications",talk:"Talks"}</script><script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin=anonymous></script><script>anchors.add()</script><script id=search-hit-fuse-template type=text/x-template>
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script><script src=/js/academic.min.6f1005d1a84220e2f466ff3d8e712f31.js></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div></body></html>
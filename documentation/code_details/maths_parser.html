<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Source Themes Academic 4.8.0"><meta name=description content="A discussion of the input deck for EPOCH would not be complete without consideration of the maths parser. The maths parser is the code which reads the input decks. The parser makes it possible that any parameter taking a numerical value (integer or real) can be input as a mathematical expression rather than as a numerical constant."><link rel=alternate hreflang=en-us href=/documentation/code_details/maths_parser.html><meta name=theme-color content="#3f51b5"><script src=/js/mathjax-config.js></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css crossorigin=anonymous title=hl-light><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark disabled><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin=anonymous async></script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js integrity crossorigin=anonymous async></script><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap"><link rel=stylesheet href=/css/academic.css><link rel=manifest href=/index.webmanifest><link rel=icon type=image/png href=/images/icon_hucf2a1ead28adac6bbe3177e5d4e4a1f0_753_32x32_fill_lanczos_center_2.png><link rel=apple-touch-icon type=image/png href=/images/icon_hucf2a1ead28adac6bbe3177e5d4e4a1f0_753_192x192_fill_lanczos_center_2.png><link rel=canonical href=/documentation/code_details/maths_parser.html><meta property="twitter:card" content="summary"><meta property="og:site_name" content="EPOCH"><meta property="og:url" content="/documentation/code_details/maths_parser.html"><meta property="og:title" content="Maths parser | EPOCH"><meta property="og:description" content="A discussion of the input deck for EPOCH would not be complete without consideration of the maths parser. The maths parser is the code which reads the input decks. The parser makes it possible that any parameter taking a numerical value (integer or real) can be input as a mathematical expression rather than as a numerical constant."><meta property="og:image" content="/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_300x300_fit_lanczos_2.png"><meta property="twitter:image" content="/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_300x300_fit_lanczos_2.png"><meta property="og:locale" content="en-us"><meta property="article:modified_time" content="2021-06-23T01:08:07+01:00"><title>Maths parser | EPOCH</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents><aside class=search-results id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=#><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/><img src=/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_0x70_resize_lanczos_2.png alt=EPOCH></a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/><img src=/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_0x70_resize_lanczos_2.png alt=EPOCH></a></div><div class="navbar-collapse main-menu-item collapse justify-content-end" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/quickstart.html><span>Quick Start</span></a></li><li class=nav-item><a class=nav-link href=/documentation.html><span>User Guide</span></a></li><li class=nav-item><a class=nav-link href=/developer.html><span>Dev Guide</span></a></li><li class=nav-item><a class=nav-link href=/publication.html><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/license.html><span>License</span></a></li><li class=nav-item><a class=nav-link href=/contact.html><span>Contact</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=#><i class="fas fa-search" aria-hidden=true></i></a></li></ul></div></nav><div class="container-fluid docs"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 docs-sidebar"><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-3" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation">
<span><i class="fas fa-bars"></i></span></button>
<input name=q type=search class=form-control placeholder=Search... autocomplete=off></form><nav class="collapse docs-links" id=docs-nav><div class=docs-toc-item><a class=docs-toc-link href=/documentation.html>Overview</a></div><div class=docs-toc-item><a class=docs-toc-link href=/documentation/basic_usage.html>Basic usage</a><ul class="nav docs-sidenav"><li><a href=/documentation/basic_usage/faq.html>FAQs</a></li><li><a href=/documentation/basic_usage/structure.html>Structure</a></li><li><a href=/documentation/basic_usage/compiling.html>Compiling</a></li><li><a href=/documentation/basic_usage/compiler_flags.html>Compiler Flags</a></li><li><a href=/documentation/basic_usage/running.html>Running</a></li><li><a href=/documentation/basic_usage/acknowledging_epoch.html>Acknowledging EPOCH</a></li><li><a href=/documentation/basic_usage/libraries.html>Libraries</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/documentation/input_deck/input_deck.html>Input deck</a><ul class="nav docs-sidenav"><li><a href=/documentation/input_deck/input_deck_antenna.html>Antenna block</a></li><li><a href=/documentation/input_deck/input_deck_boundaries.html>Boundaries block</a></li><li><a href=/documentation/input_deck/input_deck_bremsstrahlung.html>Bremsstrahlung block</a></li><li><a href=/documentation/input_deck/input_deck_collisions.html>Collisions block</a></li><li><a href=/documentation/input_deck/input_deck_constant.html>Constant block</a></li><li><a href=/documentation/input_deck/input_deck_control.html>Control block</a></li><li><a href=/documentation/input_deck/input_deck_dist_fn.html>Dist_fn block</a></li><li><a href=/documentation/input_deck/input_deck_fields.html>Fields block</a></li><li><a href=/documentation/input_deck/input_deck_injector.html>Injector block</a></li><li><a href=/documentation/input_deck/input_deck_laser.html>Laser block</a></li><li><a href=/documentation/input_deck/input_deck_output_block.html>Output block</a></li><li><a href=/documentation/input_deck/input_deck_output_global.html>Output_global block</a></li><li><a href=/documentation/input_deck/input_deck_particle_file.html>Particles_from_file block</a></li><li><a href=/documentation/input_deck/input_deck_probe.html>Probe block</a></li><li><a href=/documentation/input_deck/input_deck_qed.html>QED block</a></li><li><a href=/documentation/input_deck/input_deck_species.html>Species block</a></li><li><a href=/documentation/input_deck/input_deck_subset.html>Subset block</a></li><li><a href=/documentation/input_deck/input_deck_window.html>Window block</a></li><li><a href=/documentation/input_deck/binary_files.html>Binary files</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/documentation/code_details.html>Code details</a><ul class="nav docs-sidenav"><li class=active><a href=/documentation/code_details/maths_parser.html>Maths parser</a></li><li><a href=/documentation/code_details/using_epoch_in_practice.html>Using EPOCH in practice</a></li><li><a href=/documentation/code_details/using_delta_f.html>Using delta f</a></li><li><a href=/documentation/code_details/previous_versions.html>Previous versions</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/documentation/visualising_output.html>Visualising output</a><ul class="nav docs-sidenav"><li><a href=/documentation/visualising_output/visualising_sdf_files_with_idl_or_gdl.html>IDL or GDL</a></li><li><a href=/documentation/visualising_output/visualising_sdf_files_with_llnl_visit.html>LLNL VisIt</a></li><li><a href=/documentation/visualising_output/python_beam.html>Python BEAM</a></li><li><a href=/documentation/visualising_output/python_sdf_helper.html>Python sdf_helper</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/documentation/examples.html>Examples</a><ul class="nav docs-sidenav"><li><a href=/documentation/examples/basic_examples.html>Basic examples</a></li><li><a href=/documentation/examples/workshop_examples.html>Workshop examples</a></li><li><a href=/documentation/examples/workshop_examples_continued.html>Workshop examples continued</a></li></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>Contents</a></li></ul><nav id=TableOfContents><ul><li><ul><li><a href=#constants>Constants</a></li><li><a href=#functions>Functions</a></li><li><a href=#operators>Operators</a></li></ul></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role=main><article class=article><div class=docs-article-container><h1>Maths parser</h1><div class=article-style><p>A discussion of the input deck for EPOCH would not be complete without
consideration of the maths parser. The maths parser is the code which
reads the input decks. The parser makes it possible that any parameter
taking a numerical value (integer or real) can be input as a
mathematical expression rather than as a numerical constant. The maths
parser is fairly extensive and includes a range of mathematical
functions, physical and simulation constants and appropriately
prioritised mathematical operators.</p><h3 id=constants>Constants</h3><p>The maths parser in EPOCH has the following constants</p><ul><li>pi - The ratio of the circumference of a circle to its diameter.</li><li>kb - Boltzmann&rsquo;s constant.</li><li>me - Mass of an electron.</li><li>qe - Charge of an electron.</li><li>c - Speed of light.</li><li>epsilon0 - Permeability of free space.</li><li>mu0 - Permittivity of free space.</li><li>ev - Electronvolt.</li><li>kev - Kilo-Electronvolt.</li><li>mev - Mega-Electronvolt.</li><li>micron - A convenience symbol for specifying wavelength in microns
rather than metres.</li><li>milli - $10^{-3}$</li><li>micro - $10^{-6}$</li><li>nano - $10^{-9}$</li><li>pico - $10^{-12}$</li><li>femto - $10^{-15}$</li><li>atto - $10^{-18}$</li><li>cc - A convenience symbol for converting from cubic metres to cubic
centimetres (ie. $10^{-6}$)</li><li>time - Initial simulation time.</li><li>x,y,z - Grid coordinates in the x,y,z direction.</li><li>ix,iy,iz - Grid index in the x,y,z direction.</li><li>nx,ny,nz - Number of grid points in the x,y,z direction.</li><li>dx,dy,dz - Grid spacing in the x,y,z direction.</li><li>{x,y,z}_min - Grid coordinate of the minimum x,y,z boundary.</li><li>{x,y,z}_max - Grid coordinate of the maximum x,y,z boundary.</li><li>length_{x,y,z} - The length of the simulation box in the x,y,z
direction.</li><li>nproc_{x,y,z} - The number of processes in the x,y,z directions.</li><li>nsteps - The number of timesteps requested.</li><li>t_end - The end time of the simulation.</li><li>p{x,y,z} - Momentum in the x, y, z directions. Used in specifying
arbitrary distribution functions. EPOCH 4.15 or later required</li></ul><p>It is also possible for an end user to specify custom constants both
within the code and from the input deck. These topics are covered later
in this subsection. An example of using a constant would be:
<strong>length_x = pi</strong></p><h3 id=functions>Functions</h3><p>The maths parser in EPOCH has the following functions</p><ul><li>abs(a) - Absolute value.</li><li>floor(a) - Convert real to integer rounding down.</li><li>ceil(a) - Convert real to integer rounding up.</li><li>nint(a) - Convert real to integer rounding to nearest integer.</li><li>sqrt(a) - Square root.</li><li>sin(a) - Sine.</li><li>cos(a) - Cosine.</li><li>tan(a) - Tangent.</li><li>asin(a) - Arcsine.</li><li>acos(a) - Arccosine.</li><li>atan(a) - Arctangent.</li><li>atan2(Y,X) - Arctangent using the Fortran ATAN2 function. This computes the
principal value of the argument function of the complex number
$X + i Y$. This function can be used to transform from Cartesian into
polar coordinates and allows to determine the angle in the correct
quadrant.</li><li>sinh(a) - Hyperbolic sine.</li><li>cosh(a) - Hyperbolic cosine.</li><li>tanh(a) - Hyperbolic tangent.</li><li>exp(a) - Exponential.</li><li>loge(a) - Natural logarithm.</li><li>log10(a) - Base-10 logarithm.</li><li>log_base(a,b) - Base-b logarithm.</li><li>gauss($x,x_0,w$) - Calculate a Gaussian profile in variable
<em><code>x</code></em> centred on <em><code>$x_0$</code></em> with a
characteristic width <em><code>w</code></em>.
$f(x) = \exp{(-((x-x_0)/w)^2)}$. In this expression the full width
at half maximum is given by $fwhm = 2 w \sqrt{\ln{2}}$</li><li>supergauss($x,x_0,w,n$) - This is identical to &ldquo;gauss&rdquo; except it
takes a fourth parameter, <em><code>n</code></em>, which is the power to
raise the exponential argument to.</li><li>semigauss($t,A,A_0,w$) - Calculate a semi Gaussian profile in
variable $t$ with maximum amplitude $A$, amplitude at $t=0$ $A_0$
and width $w$. The parameter $A_0$ is used to calculate $t_0$, the
point at which the Gaussian reaches its maximum value. For $t$ less
than $t_0$ the profile is Gaussian and for $t$ greater than $t_0$ it
is the constant $A$. $t_0 = w\sqrt{-\ln{(A_0/A)}}$<math>f(t) =</li>
</ul>
<p>\begin{cases} A \exp{(-((t-t_0)/w)^2)}, &amp; t &lt; t_0 \\ A, &amp;
\mbox{otherwise} \end{cases}</math></p><ul><li>interpolate(interp_var,.&mldr;,n_pairs) - Linear interpolation
function, explained later.</li><li>if(a,b,c) - Conditional function. If a != 0 the function returns b,
otherwise the function returns c.</li><li>number_density(a) - Returns the number density for species a.</li><li>temp_{x,y,z}(a) - Returns temperature in the x, y or z direction
for species a.</li><li>temp(a) - Returns the isotropic temperature for species a.</li><li>e{x,y,z}(x,y,z) - Returns the x, y or z component of the electric
field at the specified location.</li><li>b{x,y,z}(x,y,z) - Returns the x, y or z component of the magnetic
field at the specified location.</li><li>critical($\omega$) - Returns the critical density for the given
frequency $\omega$. ie.
$n_{crit}(\omega) = \omega^2 m_0 \epsilon_0 / e^2$</li></ul><p>It is also possible for an end user to specify custom functions within
the code. An example of using a function would be:
<strong>length_x = exp(pi)</strong>
The use of most of these functions is fairly simple, but &ldquo;interpolate&rdquo;
requires some additional explanation. This function allows a user to
specify a set of position,value pairs and have the code linearly
interpolate the values between these control points. This function is
mainly intended for ease of converting initial conditions from other
existing PIC codes, and the same effect can usually be obtained more
elegantly using the &ldquo;if&rdquo; command. The structure of the &ldquo;interpolate&rdquo;
command is as follows: The first parameter is the variable which is to
be used as the axis over which to interpolate the values. This can in
general be any valid expression, but will normally just be a coordinate
axis. The next 2n entries are the position,value pairs and the final
parameter is the number of position,value pairs. The slightly clunky
syntax of this command is unfortunately necessary to allow it to work
with some fairly fundamental features of the maths parser used in EPOCH.</p><h3 id=operators>Operators</h3><p>The maths parser in EPOCH allows the following operators</p><ul><li>a + b - Addition operator.</li><li>a - b - Subtraction operator or unary negation operator
(auto-detected).</li><li>a * b - Multiplication operator.</li><li>a / b - Division operator.</li><li>a ^ b - Power raise operator.</li><li>a e b - Power of ten operator (1.0e3 = 1000).</li><li>a lt b - Less than operator. Returns 1 if a $&lt;$ b, otherwise
returns 0. Intended for use with if.</li><li>a gt b - Greater than operator. Returns 1 if a $>$ b, otherwise
returns 0.</li><li>a eq b - Equality operator. Returns 1 if a == b, otherwise
returns 0.</li><li>a and b - Logical and operator. Returns 1 if a != 0 and b != 0,
otherwise returns 0.</li><li>a or b - Logical or operator. Returns 1 if a != 0 or b != 0,
otherwise returns 0.</li></ul><p>These follow the usual rules for operator precedence, although it is
best to surround more complex expressions in parenthesis if the
precedence is important. It is not possible at this time to specify
custom operators without major changes to the code. An example of using
an operator would be:</p><pre><code class=language-perl> length_x = 10.0 + 12.0 
</code></pre></div><div class=article-widget><div class=post-nav><div class=post-nav-item><div class=meta-nav>Next</div><a href=/documentation/code_details/using_epoch_in_practice.html rel=prev>Using EPOCH in practice</a></div></div></div></div><div class=body-footer><p>Last updated on Jun 23, 2021</p></div></article><footer class=site-footer><p class=powered-by>Powered by the
<a href=https://sourcethemes.com/academic/ target=_blank rel=noopener>Academic theme</a> for
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a>.</p></footer></main></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin=anonymous></script><script>const code_highlighting=!0</script><script>const isSiteThemeDark=!1</script><script>const search_config={indexURI:"/index.json",minLength:1,threshold:.3},i18n={no_results:"No results found",placeholder:"Search...",results:"results found"},content_type={post:"Posts",project:"Projects",publication:"Publications",talk:"Talks"}</script><script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin=anonymous></script><script>anchors.add()</script><script id=search-hit-fuse-template type=text/x-template>
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script><script src=/js/academic.min.6f1005d1a84220e2f466ff3d8e712f31.js></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div></body></html>
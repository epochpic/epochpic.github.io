<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Source Themes Academic 4.8.0"><meta name=description content="In the PIC method, the simulation grid is filled with macro-particles, which respresent a large number of real particles. They are described primarily by a position on the grid, and a momentum, charge, mass and weight."><link rel=alternate hreflang=en-us href=/developer/core_structure/macro_particles.html><meta name=theme-color content="#3f51b5"><script src=/js/mathjax-config.js></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css crossorigin=anonymous title=hl-light><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark disabled><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin=anonymous async></script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js integrity crossorigin=anonymous async></script><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap"><link rel=stylesheet href=/css/academic.css><link rel=manifest href=/index.webmanifest><link rel=icon type=image/png href=/images/icon_hucf2a1ead28adac6bbe3177e5d4e4a1f0_753_32x32_fill_lanczos_center_2.png><link rel=apple-touch-icon type=image/png href=/images/icon_hucf2a1ead28adac6bbe3177e5d4e4a1f0_753_192x192_fill_lanczos_center_2.png><link rel=canonical href=/developer/core_structure/macro_particles.html><meta property="twitter:card" content="summary"><meta property="og:site_name" content="EPOCH"><meta property="og:url" content="/developer/core_structure/macro_particles.html"><meta property="og:title" content="Particles | EPOCH"><meta property="og:description" content="In the PIC method, the simulation grid is filled with macro-particles, which respresent a large number of real particles. They are described primarily by a position on the grid, and a momentum, charge, mass and weight."><meta property="og:image" content="/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_300x300_fit_lanczos_2.png"><meta property="twitter:image" content="/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_300x300_fit_lanczos_2.png"><meta property="og:locale" content="en-us"><meta property="article:modified_time" content="2025-07-30T17:38:24+01:00"><title>Particles | EPOCH</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents><aside class=search-results id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=#><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/><img src=/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_0x70_resize_lanczos_2.png alt=EPOCH></a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/><img src=/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_0x70_resize_lanczos_2.png alt=EPOCH></a></div><div class="navbar-collapse main-menu-item collapse justify-content-end" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/quickstart.html><span>Quick Start</span></a></li><li class=nav-item><a class=nav-link href=/documentation.html><span>User Guide</span></a></li><li class=nav-item><a class=nav-link href=/developer.html><span>Dev Guide</span></a></li><li class=nav-item><a class=nav-link href=/publication.html><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/license.html><span>License</span></a></li><li class=nav-item><a class=nav-link href=/contact.html><span>Contact</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=#><i class="fas fa-search" aria-hidden=true></i></a></li></ul></div></nav><div class="container-fluid docs"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 docs-sidebar"><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-3" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation">
<span><i class="fas fa-bars"></i></span></button>
<input name=q type=search class=form-control placeholder=Search... autocomplete=off></form><nav class="collapse docs-links" id=docs-nav><div class=docs-toc-item><a class=docs-toc-link href=/developer.html>Overview</a><ul class="nav docs-sidenav"><li><a href=/developer/source_code_files.html>Source code files</a></li><li><a href=/developer/makefile.html>Makefile</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/developer/core_structure.html>Core Structure</a><ul class="nav docs-sidenav"><li><a href=/developer/core_structure/basic_structures.html>Basic Structures</a></li><li class=active><a href=/developer/core_structure/macro_particles.html>Particles</a></li><li><a href=/developer/core_structure/linked_lists.html>Linked Lists</a></li><li><a href=/developer/core_structure/partlist.html>Partlist</a></li><li><a href=/developer/core_structure/field_solver.html>Field Solver</a></li><li><a href=/developer/core_structure/particle_pusher.html>Particle Pusher</a></li><li><a href=/developer/core_structure/shape_functions.html>Weighting Functions</a></li><li><a href=/developer/core_structure/current_solver.html>Current solver</a></li><li><a href=/developer/core_structure/boundary_conditions.html>Boundary Conditions</a></li><li><a href=/developer/core_structure/parallelism.html>Parallelism</a></li><li><a href=/developer/core_structure/precompiler_flags.html>Pre-compilation Flags</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/developer/input_output.html>Input Output</a><ul class="nav docs-sidenav"><li><a href=/developer/input_output/basic_output.html>Basic Output</a></li><li><a href=/developer/input_output/string_handling.html>String Handling</a></li><li><a href=/developer/input_output/error_codes.html>Error Codes</a></li><li><a href=/developer/input_output/adding_outputs.html>Adding Outputs</a></li><li><a href=/developer/input_output/custom_maths_parser.html>Custom Maths Parser</a></li><li><a href=/developer/input_output/custom_deck.html>Custom Deck</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/developer/extensions.html>Extending EPOCH</a><ul class="nav docs-sidenav"><li><a href=/developer/extensions/input_deck.html>Input Deck</a></li><li><a href=/developer/extensions/maths_parser.html>Maths Parser</a></li><li><a href=/developer/extensions/new_modules.html>New Module</a></li><li><a href=/developer/extensions/new_particle_variable.html>New Particle Variable</a></li></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>Contents</a></li></ul><nav id=TableOfContents><ul><li><a href=#the-particle-data-type>The particle data-type</a></li><li><a href=#particle-list-type>Particle list type</a></li><li><a href=#particle-species-type>Particle species type</a></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role=main><article class=article><div class=docs-article-container><h1>Particles</h1><div class=article-style><p>In the PIC method, the simulation grid is filled with macro-particles, which
respresent a large number of <em>real</em> particles. They are described primarily by a
position on the grid, and a momentum, charge, mass and weight. In EPOCH, the
first few variables describe a <em>single</em> real particle within the macro-particle,
and the weight describes how many real particles the macro-particle represents.</p><p>Macro-particles are split between different species, set by the species blocks
in the input deck. All macro-particles present on a single rank are contained
within the <code>species_list</code> variable, which contains lists of particles for all
species present, along with information about each species.</p><p>In short, the data is distributed among types as follows:</p><ul><li>Particle type: contains information about a single macro-particle.</li><li>Particle list: a linked list object, containing a list of macro-particles.</li><li>Particle species: contains information about a set of particles as a whole,
and a corresponding particle list.</li><li>Species list: an array containing all the particle species.</li></ul><h2 id=the-particle-data-type>The particle data-type</h2><p>Particles are represented as linked lists of Fortran TYPES. The definition can
be found in <code>shared_data.F90</code>, which is shared globally among all modules.
Hence, any module can use a particle data-type.</p><p>In this data-type, you will
notice that many parameters are locked behind pre-processor flags, and must
be manually switched on through the Makefile. This is because as particles move
around the grid, they must be transferred from processor to processor as they
move in and out of cells controlled by each rank. This MPI transfer is a major
bottleneck for the code, so by default, EPOCH assigns the minimum amount of
information to each particle, to minimise the rank-to-rank data transfer.</p><p>The datatype is shown here:</p><pre><code class=language-perl>TYPE particle  
   REAL(num), DIMENSION(3) :: part_p
   REAL(num), DIMENSION(c_ndims) :: part_pos
#if !defined(PER_SPECIES_WEIGHT) || defined(PHOTONS)
   REAL(num) :: weight
#endif
#ifdef DELTAF_METHOD
   REAL(num) :: pvol
#endif
#ifdef PER_PARTICLE_CHARGE_MASS
   REAL(num) :: charge
   REAL(num) :: mass
#endif
   TYPE(particle), POINTER :: next, prev
#ifdef PARTICLE_DEBUG
   INTEGER :: processor
   INTEGER :: processor_at_t0
#endif
#ifdef PARTICLE_ID4
   INTEGER :: id
#elif PARTICLE_ID
   INTEGER(i8) :: id
#endif
#ifdef WORK_DONE_INTEGRATED
   REAL(num) :: work_x
   REAL(num) :: work_y
   REAL(num) :: work_z
   REAL(num) :: work_x_total
   REAL(num) :: work_y_total
   REAL(num) :: work_z_total
#endif
#ifdef PHOTONS
   REAL(num) :: optical_depth
#endif
#if defined(PHOTONS) || defined(BREMSSTRAHLUNG)
   REAL(num) :: particle_energy
#endif
#if defined(PHOTONS) &amp;&amp; defined(TRIDENT_PHOTONS)
   REAL(num) :: optical_depth_tri
#endif
#ifdef BREMSSTRAHLUNG
   REAL(num) :: optical_depth_bremsstrahlung
#endif
#if defined(PROBE_TIME)
   REAL(num) :: probe_time
#endif
END TYPE particle
</code></pre><p>And the descriptions are</p><ul><li><code>REAL(num) :: part_p(3)</code> - The particle momentum. Always dimension 3 even
in 1D and 2D codes. Describes the momentum of a single particle within the
macro-particle.</li><li><code>REAL(num) :: part_pos(ndims)</code> - The particle position. Has
the same dimensions as that of the code.</li><li><code>REAL(num) :: weight</code> - The particle weight if the code is running with
per particle weighting (otherwise weight is a species parameter).</li><li><code>REAL(num) :: charge</code> - The particle charge in Coulombs if the code is
running with per particle charge (otherwise charge is a species parameter).</li><li><code>REAL(nun) :: mass</code> - The particle mass in kilograms if the code is
running with per particle mass (otherwise mass is a species parameter).</li><li><code>TYPE(particle), POINTER :: next, prev</code> - The pointers to the next and
previous elements of the linked list.</li><li><code>INTEGER :: processor</code> - The rank of the processor that the particle
thinks it is on. Used for debugging.</li><li><code>INTEGER :: processor_at_t0</code> - The rank of the processor that the
particle started on. Used for debugging.</li><li><code>INTEGER :: id</code> - A unique integer assigned to each particle, only set for
species which output the id, and only when the code is compiled with ID
support.</li><li><code>REAL(num) :: work_{x,y,z}</code> - Work done by the electric field on the
particle during the last particle push, in each direction.
Describes work done to a single particle within the macro-particle.</li><li><code>REAL(num) :: work_{x,y,z}_total</code> - Work done by the electric fields on the
particle over the full simulation, in each direction.
Describes work done to a single particle within the macro-particle.</li><li><code>REAL(num) :: optical_depth</code> - For some secondary-particle emission processes,
a particle is assigned an &ldquo;optical depth of emission&rdquo;, related to how far the
particle has moved, and the cross section of emission. The total optical depth
is tracked, and an emission is sampled once the optical_depth goes negative.
The original <code>optical_depth</code> here describes the remaining optical depth to
travel
before photon emission through the QED non-linear Compton scatter process for
electrons. For photons, this describes the remaining optical depth before
Breit-Wheeler pair production.</li><li><code>REAL(num) :: particle_energy</code> - Contains the relativistic particle energy,
primarily for use in the QED routines.</li><li><code>REAL(num) :: optical_depth_tri</code> - Remaining optical depth before emission of
a pair through the electron trident process.</li><li><code>REAL(num) :: optical_depth_bremsstrahlung</code> - Remaining optical depth before
emission of a bremsstrahlung photon for electrons, or a Bethe-Heitler pair
for photons.</li><li><code>REAL(num) :: probe_time</code> - If a particle passes a probe, a copy of the
particle is stored in a new list. This parameter is set to the time the
particle passes the probe, for the particle copy.</li></ul><p><strong>WARNING</strong>: Simply adding a new parameter to the definition of the particle
type is NOT
sufficient to extend the particle type, since the communications when the
particle crosses a processor boundary do not know about the new parameter and
it will not be transmitted with the particle. How to add new properties to the
particle communication layer is described later.</p><h2 id=particle-list-type>Particle list type</h2><p>The entire linked list of particles is encapsulated in another Fortran TYPE,
called <code>particle_list</code>, which is defined as:</p><pre><code class=language-perl>TYPE particle_list
 TYPE(particle), POINTER :: head
 TYPE(particle), POINTER :: tail
 INTEGER(KIND=8) :: count
 ! Pointer is safe if the particles in it are all unambiguously linked
 LOGICAL :: safe

 TYPE(particle_list), POINTER :: next, prev
END TYPE particle_list
</code></pre><p>And its properties are:</p><ul><li><p><code>TYPE(particle), POINTER :: head</code> - The first particle in the linked list.</p></li><li><p><code>TYPE(particle), POINTER :: tail</code> - The last particle in the linked
list. New particles added to the end of the list are added onto the end of
the tail element, and the new last particle becomes the new tail element.</p></li><li><p><code>INTEGER(KIND=8) :: count</code> - The number of particles in this particle
list. Note that the <code>particle_list</code> type is not
directly MPI aware, so this is literally the number of particles in
<em>this</em> particle list, not the number of particles of this species on all
processors.</p></li><li><p><code>LOGICAL :: safe</code> - A particle list <em>safe</em> if the particles in it
are unambiguously linked. That is that the <code>count</code>th particle is
guaranteed to have its <code>next</code> property be null. Most particle
lists within EPOCH are safe, but sometimes it is useful to be able to have
particle lists which are subsets of longer particles lists, and these
particle lists are not <em>safe</em>.</p></li><li><p><code>TYPE(particle_list), POINTER :: next, prev</code> - At present, EPOCH does
not use these pointers, which are intended to allow multiple particle lists to
be attached together. Certain parts of EPOCH, such as the I/O system are
aware of these pointers and will automatically use them if they are ever
set. They are reserved for future use.</p></li></ul><p>The <code>particle_list</code> objects are used to abstract all the functions
of the linked list, including adding and removing particles and transporting
particles between processors.</p><h2 id=particle-species-type>Particle species type</h2><p>The particle species are represented by yet another Fortran TYPE, this time
called <code>particle_species</code>, which in 2D is defined as:</p><pre><code class=language-perl>TYPE particle_species
   ! Core properties
   CHARACTER(string_length) :: name
   TYPE(particle_species), POINTER :: next, prev
   INTEGER :: id
   INTEGER :: dumpmask
   INTEGER :: count_update_step

   REAL(num) :: charge
   REAL(num) :: mass
   REAL(num) :: weight
   INTEGER(i8) :: count
   TYPE(particle_list) :: attached_list
   TYPE(particle_pointer_list), POINTER :: boundary_particles =&gt; NULL()
   LOGICAL :: immobile
   LOGICAL :: fill_ghosts

   ! Parameters for relativistic and arbitrary particle loader
   INTEGER :: ic_df_type
   REAL(num) :: fractional_tail_cutoff

   TYPE(primitive_stack) :: dist_fn
   TYPE(primitive_stack) :: dist_fn_range(3)

#ifndef NO_TRACER_PARTICLES
   LOGICAL :: zero_current
#endif

   INTEGER :: atomic_no
   LOGICAL :: atomic_no_set = .FALSE.

   ! Specify if species is background species or not
   LOGICAL :: background_species = .FALSE.
   ! Background density
   REAL(num), DIMENSION(:,:), POINTER :: background_density
   ! Do we need to make secondary lists for this species?
   LOGICAL :: make_secondary_list = .FALSE.
   ! Has species list been randomised in order?
   LOGICAL :: is_shuffled

   ! Specifiy if species is background for collisions
   LOGICAL :: coll_background = .FALSE.
   LOGICAL :: coll_fast = .FALSE.
   LOGICAL :: coll_pairwise = .FALSE.

   ! ID code which identifies if a species is of a special type
   INTEGER :: species_type

   ! particle cell division
   INTEGER(i8) :: global_count
   ! Secondary list
   TYPE(particle_list), DIMENSION(:,:), POINTER :: secondary_list

   ! Loading of particles
   REAL(num) :: npart_per_cell
   TYPE(primitive_stack) :: density_function, temperature_function(3)
   TYPE(primitive_stack) :: drift_function(3)

   ! Thermal boundaries
   REAL(num), DIMENSION(:,:), POINTER :: ext_temp_x_min, ext_temp_x_max
   REAL(num), DIMENSION(:,:), POINTER :: ext_temp_y_min, ext_temp_y_max

   ! Species_ionisation
   LOGICAL :: electron
   LOGICAL :: ionise
   INTEGER :: ionise_to_species
   INTEGER :: release_species
   INTEGER :: n
   INTEGER :: l
   REAL(num) :: ionisation_energy
   REAL(num), ALLOCATABLE :: coll_ion_incident_ke(:)
   REAL(num), ALLOCATABLE :: coll_ion_cross_sec(:)
   REAL(num), ALLOCATABLE :: coll_ion_mean_bind(:,:)
   REAL(num), ALLOCATABLE :: coll_ion_secondary_ke(:,:)
   REAL(num), ALLOCATABLE :: coll_ion_secondary_cdf(:,:)

   ! Attached probes for this species
#ifndef NO_PARTICLE_PROBES
   TYPE(particle_probe), POINTER :: attached_probes
#endif

   ! Particle migration
   TYPE(particle_species_migration) :: migrate

   ! Initial conditions
   TYPE(initial_condition_block) :: initial_conditions

   ! Per-species boundary conditions
   INTEGER, DIMENSION(2*c_ndims) :: bc_particle
 END TYPE particle_species
</code></pre><p>Again, most of these properties are self explanatory, but they are detailed
below.</p><ul><li><p><code>CHARACTER(LEN=entry_length) :: name</code> - The name of the particle
species. Used when constructing things like &ldquo;ekbar_electron&rdquo; and similar
names.</p></li><li><p><code>TYPE(particle_species), POINTER :: next, prev</code> - Particle species are
connected to each other as a linked list using pointers as well as being
available through a simple array. These pointers are used behind the scenes
in the I/O.</p></li><li><p><code>INTEGER :: id</code> - The number of the species, so for the species
<code>species_list(1)</code>, the id field would be 1. For
<code>species_list(2)</code>, the id field would be 2 etc.</p></li><li><p><code>INTEGER :: dumpmask</code> - Bitmask to determine when this species should be
dumped in diagnostic output.</p></li><li><p><code>INTEGER :: count_update_step</code> - The last step where the <code>count</code> parameter
was updated.</p></li><li><p><code>REAL(num) :: charge</code> - The charge on a single particle of the species in
Coulombs.</p></li><li><p><code>REAL(num) :: mass</code> - The mass of a single particle of the species in
kilograms.</p></li><li><p><code>REAL(num) :: weight</code> - The per-species particle weight.</p></li><li><p><code>INTEGER(KIND=8) :: count</code> - The number of particles of this species on
all processors. NOTE that this is only accurate if the code is compiled with
the correct preprocessor options. Without the correct preprocessor options,
this will be accurate at the start of the code runtime, but will not be if
any particles enter or leave the domain. This is mainly a debugging
parameter.</p></li><li><p><code>TYPE(particle_list) :: attached_list</code> - This is the
<code>particle_list</code> object which holds the particles assigned to this
species on this processor. Particles are attached to this list except between
the calls to <code>reorder_particles_to_grid</code> and
<code>reattach_particles_to_mainlist</code> in
<code>epoch{1,2,3}d.F90</code> where the particles are instead attached to
<code>secondary_list</code>. This is explained later.</p></li><li><p><code>TYPE(particle_pointer_list), POINTER :: boundary_particles</code> - A list of
particles which have been pushed out of the simulation boundaries.</p></li><li><p><code>LOGICAL :: immobile</code> - These particles skip the particle push if true.</p></li><li><p><code>LOGICAL :: fill_ghosts</code> - Loads particles into ghost cells surrounding the
simulation if true.</p></li><li><p><code>INTEGER :: ic_df_type</code> - Sets temperature calculation for the delta-f loader.</p></li><li><p><code>REAL(num) :: fractional_tail_cutoff</code> - Sets a cut-off for the relativistic
temperature to momentum calculation in
<code>src/user_interaction/particle_temperature.F90</code></p></li><li><p><code>TYPE(primitive_stack) :: dist_fn</code> - Arbitrary momentum distribution function
for particle loading.</p></li><li><p><code>TYPE(primitive_stack) :: dist_fn_range(3)</code> - Set upper and lower ranges to
the momentum distribution functions.</p></li><li><p><code>LOGICAL :: zero_current</code> - Whether or not this species is a tracer particle.
If
a species is a tracer species then it moves under the fields as normal for a
particle with its mass and charge but contributes no current.</p></li><li><p><code>INTEGER :: atomic_no</code> - Set atomic number of species. Used for bremsstrahlung
and ionisation.</p></li><li><p><code>LOGICAL :: atomic_no_set</code> - Identifies is an atomic number has been set for
the species.</p></li><li><p><code>LOGICAL :: background_species</code> - If true, the species is not to load any
particles. Instead, this is represented with a density value in each cell,
and it can only act as a target species for bremsstrahlung radiation.</p></li><li><p><code>REAL(num), DIMENSION(:,:,:), POINTER :: background_density</code> - The number
density of a background species (for bremsstrahlung radiation).</p></li><li><p><code>LOGICAL :: make_secondary_list</code> - Checks if this species will ever need to
create a secondary list (see <code>secondary_list</code>).</p></li><li><p><code>LOGICAL :: is_shuffled</code> - Checks if the order of particles in secondary lists
has been randomised</p></li><li><p><code>LOGICAL :: coll_background</code>- Checks if this species forms the background
species in a fast-background pair for background particle collisions.</p></li><li><p><code>LOGICAL :: coll_fast</code> - Checks if this species describes the fast species in
a fast-background pair for background particle collisions.</p></li><li><p><code>LOGICAL :: coll_pairwise</code> - Checks if this species undergoes binary
collisions with another species.</p></li><li><p><code>INTEGER :: species_type</code> - Tag the species as a particular type of particle,
using constants like <code>c_species_id_electron</code>. This is required for the
physics packages.</p></li><li><p><code>INTEGER(i8) :: global_count</code> - The number of particles from this species
summed over all ranks.</p></li><li><p><code>TYPE(particle_list), DIMENSION(:,:,:), POINTER :: secondary_list</code> - This
describes an array of particle lists. The subroutine
<code>reorder_particles_to_grid</code> allocates
<code>secondary_list(0:nx+1,0:ny+1,0:nz+1)</code> and then loops over all
particles. It calculates the cell in which each particle is and moves the
particle from <code>attached_list</code> to the correct element of
<code>secondary_list</code> for that cell. This means the particles which
are nearby in space are now linked together in an array of linked lists.
This allows things such as collision operators which require direct
interaction between nearby particles.</p></li><li><p><code>INTEGER(KIND=8) :: npart_per_cell</code> - The number of pseudoparticles per
cell in the initial conditions. This is used with the moving window function
to ensure that the same number of particles per cell are used for the new
material introduced at the leading edge of the window.</p></li><li><p><code>REAL(num), DIMENSION(:,:), POINTER :: density</code> - The density of the
plasma at the leading edge of the window at the start of the simulation. This
is used to structure the density of the new material introduced at the leading
edge of the plasma.</p></li><li><p><code>REAL(num), DIMENSION(:,:,:), POINTER :: temperature</code> - The temperature
in of the plasma at the leading edge of a moving window at the start of the
simulation. The final index of the array is the direction in which the
temperature is set (1=x, 2=y, 3=z).</p></li><li><p><code>REAL(num), DIMENSION(:,:,:), POINTER :: ext_temp_{x,y,z}_{min,max}</code> - Sets
the temperature on the boundary for this particle species if <code>thermal</code>
boundaries have been used.</p></li><li><p><code>LOGICAL :: electron</code> - Species is tagged as an electron for the ionisation
routines.</p></li><li><p><code>LOGICAL :: ionise</code> - If the ionisation model is activated then this
species should ionise.</p></li><li><p><code>INTEGER :: ionise_to_species</code> - The species number for the next ionised
state of this species.</p></li><li><p><code>INTEGER :: release_species</code> - Specifies what type of particle should be
released when this species ionises (i.e. which species is the electron).</p></li><li><p><code>REAL(num) :: ionisation_energy</code> - The ionisation energy for the next
ionisation of this species.</p></li><li><p><code>INTEGER :: n, l</code> - The principle and angular quantum numbers of the
outermost electron for this species, assuming a ground-state electron
configuration. This is used for field ionisation.</p></li><li><p><code>REAL(num), ALLOCATABLE :: coll_ion_incident_ke(:)</code> - A table of
logarithmically spaced kinetic energy values for incident electrons in
collisional ionisation.</p></li><li><p><code>REAL(num), ALLOCATABLE :: coll_ion_cross_sec(:)</code> - The collisional
ionisation cross sections corresponding to incident electrons with kinetic
energies given by <code>coll_ion_incident_ke(:)</code>.</p></li><li><p><code>REAL(num), ALLOCATABLE :: coll_ion_mean_bind(:,:)</code> - For each
incident/ejected electron energy pair for collisional ionisation,
this gives the mean bound electron energy, weighted by the ionisation cross
section of each bound shell.</p></li><li><p><code>REAL(num), ALLOCATABLE :: coll_ion_secondary_ke(:,:)</code> - An array of possible
ejected electron energies for each incident electron kinetic energy in the
<code>coll_ion_incident_ke(:)</code> table.</p></li><li><p><code>REAL(num), ALLOCATABLE :: coll_ion_secondary_cdf(:,:)</code> - The cumulative
distribution function for the probability of emission of an ejected electron
energy for a given incident energy during collisional ionisation,
corresponding to the energies in <code>coll_ion_secondary_ke</code>.</p></li><li><p><code>TYPE(particle_probe), POINTER :: attached_probes</code> - A pointer pointing to
the head of an attached linked list of particle probe diagnostics.</p></li><li><p><code>TYPE(particle_species_migration) :: migrate</code> - Determines the criteria for
particles being moved to other species, using the particle migration routines.</p></li><li><p><code>TYPE(initial_condition_block) :: initial_conditions</code> - Stores parameters
read from the species block, describing the initial conditions of the species.</p></li><li><p><code>INTEGER, DIMENSION(2*c_ndims) :: bc_particle</code> - Boundary conditions for
particles in this species, which override the global boundaries set in the
input deck boundary block.</p></li></ul></div><div class=article-widget><div class=post-nav><div class=post-nav-item><div class=meta-nav>Previous</div><a href=/developer/core_structure/particle_pusher.html rel=next>Particle Pusher</a></div><div class=post-nav-item><div class=meta-nav>Next</div><a href=/developer/core_structure/partlist.html rel=prev>Partlist</a></div></div></div></div><div class=body-footer><p>Last updated on Jul 30, 2025</p></div></article><footer class=site-footer><p class=powered-by>Powered by the
<a href=https://sourcethemes.com/academic/ target=_blank rel=noopener>Academic theme</a> for
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a>.</p></footer></main></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin=anonymous></script><script>const code_highlighting=!0</script><script>const isSiteThemeDark=!1</script><script>const search_config={indexURI:"/index.json",minLength:1,threshold:.3},i18n={no_results:"No results found",placeholder:"Search...",results:"results found"},content_type={post:"Posts",project:"Projects",publication:"Publications",talk:"Talks"}</script><script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin=anonymous></script><script>anchors.add()</script><script id=search-hit-fuse-template type=text/x-template>
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script><script src=/js/academic.min.6f1005d1a84220e2f466ff3d8e712f31.js></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div></body></html>